---
title: "Introducing the bike crash dataset"
author: "Sighvatur S. Davidsson"
date: '2022-02-04'
slug: []
categories: []
tags: []
---

<script src="{{< blogdown/postref >}}index.en_files/header-attrs/header-attrs.js"></script>


<p>For my first few blog posts, I plan on using this <em>bike crash</em>-dataset that I also used for my final thesis studying Data Analytics at Dania Academy. I have already done some <a href="https://github.com/sdavidsson90/bike_crash/blob/main/code/data_preprocessing.R">preprocessing</a>, and now I want to present some of the challanges and oppurtunities that present themselves in working with this dataset.</p>
<p><strong>Short introduction to the dataset:</strong></p>
<p>This dataset contains information on crashes between cyclists and motorised vehicles (cars, motorcycles, etc.) taking place in North Carolina in the period 2007 - 2019. The dataset has been made available by the local authorities (North Carolina Division of Motor Vehicles). The information is sourced from police reports, and has manually been put in tabular form by the University of North Carolina. Overall quality of registrations is therefore assumed to be high.</p>
<p>There is however a problem with documentation. We don’t have explanations for the variables’ meaning but have to rely on their names (which are often abbrevations) and the content of the registrations.</p>
<p>The original dataset can be accesed <a href="https://www.pedbikeinfo.org/pbcat_nc/_bicycle.cfm">here</a>, and officially provided information about the dataset <a href="https://www.pedbikeinfo.org/pbcat_nc/_bicycle-about.cfm">here</a>.</p>
<p><strong>Why was this dataset chosen?</strong></p>
<p>An important criterion for choosing a dataset to work with was to avoid being acused of plagiarizing. The dataset was posted on Kaggle, but no machine learning solutions had been posted.</p>
<p><strong>Let’s have a quick look at the dataset</strong></p>
<pre class="r"><code># Load packages
pacman::p_load(tidyverse)

# Read in datasets
bike_crash &lt;- read_rds(&quot;~/R/Projects/bike_crash/processed_data/bike_crash.rds&quot;)

# Let&#39;s take a quick look at the properties of the data
skimr::skim(bike_crash)</code></pre>
<table>
<caption><span id="tab:Workspace">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">bike_crash</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">12173</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">55</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">34</td>
</tr>
<tr class="odd">
<td align="left">factor</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bike_alc_drg</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">bike_alc_flg</td>
<td align="right">654</td>
<td align="right">0.95</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">bike_dir</td>
<td align="right">461</td>
<td align="right">0.96</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">bike_injury</td>
<td align="right">374</td>
<td align="right">0.97</td>
<td align="right">6</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">bike_pos</td>
<td align="right">603</td>
<td align="right">0.95</td>
<td align="right">5</td>
<td align="right">40</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">bike_race</td>
<td align="right">299</td>
<td align="right">0.98</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">bike_sex</td>
<td align="right">235</td>
<td align="right">0.98</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">city</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">20</td>
<td align="right">0</td>
<td align="right">333</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">county</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">crash_alcoh</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">crash_grp</td>
<td align="right">97</td>
<td align="right">0.99</td>
<td align="right">7</td>
<td align="right">56</td>
<td align="right">0</td>
<td align="right">20</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">crash_loc</td>
<td align="right">10</td>
<td align="right">1.00</td>
<td align="right">11</td>
<td align="right">20</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">crash_type</td>
<td align="right">2580</td>
<td align="right">0.79</td>
<td align="right">11</td>
<td align="right">62</td>
<td align="right">0</td>
<td align="right">64</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">developmen</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">10</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">drvr_alc_drg</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">drvr_alc_flg</td>
<td align="right">1762</td>
<td align="right">0.86</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">drvr_injury</td>
<td align="right">1754</td>
<td align="right">0.86</td>
<td align="right">6</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">drvr_race</td>
<td align="right">1699</td>
<td align="right">0.86</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">drvr_sex</td>
<td align="right">1666</td>
<td align="right">0.86</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">drvr_veh_typ</td>
<td align="right">1000</td>
<td align="right">0.92</td>
<td align="right">3</td>
<td align="right">36</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">hit_run</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rd_bent</td>
<td align="right">77</td>
<td align="right">0.99</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rd_hill</td>
<td align="right">77</td>
<td align="right">0.99</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rd_class</td>
<td align="right">91</td>
<td align="right">0.99</td>
<td align="right">8</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rd_conditio</td>
<td align="right">40</td>
<td align="right">1.00</td>
<td align="right">5</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rd_config</td>
<td align="right">143</td>
<td align="right">0.99</td>
<td align="right">20</td>
<td align="right">41</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rd_defects</td>
<td align="right">55</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rd_feature</td>
<td align="right">547</td>
<td align="right">0.96</td>
<td align="right">5</td>
<td align="right">34</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rd_surface</td>
<td align="right">57</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">16</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">region</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">7</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rural_urban</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">traff_cntrl</td>
<td align="right">153</td>
<td align="right">0.99</td>
<td align="right">5</td>
<td align="right">35</td>
<td align="right">0</td>
<td align="right">13</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">weather</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">40</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">workzone</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ambulance_r</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">Yes: 8275, No: 3898</td>
</tr>
<tr class="even">
<td align="left">bike_age_grp</td>
<td align="right">225</td>
<td align="right">0.98</td>
<td align="left">FALSE</td>
<td align="right">11</td>
<td align="left">50-: 1743, 40-: 1664, 20-: 1491, 30-: 1448</td>
</tr>
<tr class="odd">
<td align="left">crash_day</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="left">FALSE</td>
<td align="right">7</td>
<td align="left">Fri: 1910, Thu: 1840, Wed: 1838, Tue: 1829</td>
</tr>
<tr class="even">
<td align="left">crash_hour</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="left">FALSE</td>
<td align="right">24</td>
<td align="left">17: 1304, 16: 1120, 18: 1110, 15: 928</td>
</tr>
<tr class="odd">
<td align="left">crash_month</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="left">FALSE</td>
<td align="right">12</td>
<td align="left">Sep: 1347, Aug: 1330, Jul: 1287, Jun: 1245</td>
</tr>
<tr class="even">
<td align="left">crash_sevr</td>
<td align="right">76</td>
<td align="right">0.99</td>
<td align="left">FALSE</td>
<td align="right">5</td>
<td align="left">Sus: 5057, Pos: 4716, No : 1396, Sus: 650</td>
</tr>
<tr class="odd">
<td align="left">crash_year</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="left">FALSE</td>
<td align="right">13</td>
<td align="left">201: 1020, 200: 1018, 200: 1001, 201: 1000</td>
</tr>
<tr class="even">
<td align="left">drvr_age_grp</td>
<td align="right">1675</td>
<td align="right">0.86</td>
<td align="left">FALSE</td>
<td align="right">8</td>
<td align="left">30-: 1909, 40-: 1796, 50-: 1550, 20-: 1281</td>
</tr>
<tr class="odd">
<td align="left">light_cond</td>
<td align="right">66</td>
<td align="right">0.99</td>
<td align="left">FALSE</td>
<td align="right">6</td>
<td align="left">Day: 8973, Dar: 1454, Dar: 1109, Dus: 408</td>
</tr>
<tr class="even">
<td align="left">locality</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="left">Urb: 8700, Rur: 1763, Mix: 1710</td>
</tr>
<tr class="odd">
<td align="left">speed_limit</td>
<td align="right">586</td>
<td align="right">0.95</td>
<td align="left">FALSE</td>
<td align="right">6</td>
<td align="left">30 : 4821, 40 : 2623, 20 : 2042, 50 : 1369</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="10%" />
<col width="7%" />
<col width="10%" />
<col width="9%" />
<col width="8%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">-79.27</td>
<td align="right">1.55</td>
<td align="right">-84.15</td>
<td align="right">-80.70</td>
<td align="right">-78.95</td>
<td align="right">-78.01</td>
<td align="right">-75.46</td>
<td align="left">▁▅▅▇▂</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">35.46</td>
<td align="right">0.57</td>
<td align="right">33.87</td>
<td align="right">35.17</td>
<td align="right">35.59</td>
<td align="right">35.92</td>
<td align="right">36.56</td>
<td align="left">▂▂▆▇▃</td>
</tr>
<tr class="odd">
<td align="left">objectid_1</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">6087.00</td>
<td align="right">3514.19</td>
<td align="right">1.00</td>
<td align="right">3044.00</td>
<td align="right">6087.00</td>
<td align="right">9130.00</td>
<td align="right">12173.00</td>
<td align="left">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td align="left">bike_age</td>
<td align="right">252</td>
<td align="right">0.98</td>
<td align="right">32.80</td>
<td align="right">17.86</td>
<td align="right">0.00</td>
<td align="right">18.00</td>
<td align="right">29.00</td>
<td align="right">48.00</td>
<td align="right">93.00</td>
<td align="left">▆▇▆▃▁</td>
</tr>
<tr class="odd">
<td align="left">crash_id</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">103879516.94</td>
<td align="right">1200168.07</td>
<td align="right">101878313.00</td>
<td align="right">102864564.00</td>
<td align="right">103792100.00</td>
<td align="right">104886632.00</td>
<td align="right">106207853.00</td>
<td align="left">▇▇▇▆▅</td>
</tr>
<tr class="even">
<td align="left">drvr_age</td>
<td align="right">1873</td>
<td align="right">0.85</td>
<td align="right">42.18</td>
<td align="right">17.40</td>
<td align="right">9.00</td>
<td align="right">27.00</td>
<td align="right">40.00</td>
<td align="right">55.00</td>
<td align="right">99.00</td>
<td align="left">▆▇▇▃▁</td>
</tr>
<tr class="odd">
<td align="left">latitude</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">35.46</td>
<td align="right">0.57</td>
<td align="right">33.87</td>
<td align="right">35.17</td>
<td align="right">35.59</td>
<td align="right">35.92</td>
<td align="right">36.56</td>
<td align="left">▂▂▆▇▃</td>
</tr>
<tr class="even">
<td align="left">longitude</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">-79.27</td>
<td align="right">1.55</td>
<td align="right">-84.15</td>
<td align="right">-80.70</td>
<td align="right">-78.95</td>
<td align="right">-78.01</td>
<td align="right">-75.46</td>
<td align="left">▁▅▅▇▂</td>
</tr>
<tr class="odd">
<td align="left">num_lanes</td>
<td align="right">711</td>
<td align="right">0.94</td>
<td align="right">2.92</td>
<td align="right">1.43</td>
<td align="right">1.00</td>
<td align="right">2.00</td>
<td align="right">2.00</td>
<td align="right">4.00</td>
<td align="right">9.00</td>
<td align="left">▇▃▁▁▁</td>
</tr>
<tr class="even">
<td align="left">num_units</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.02</td>
<td align="right">0.17</td>
<td align="right">1.00</td>
<td align="right">2.00</td>
<td align="right">2.00</td>
<td align="right">2.00</td>
<td align="right">7.00</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<p>If we think of the coordinate variable (representing crash location) as one variable - we have a total number of 52 variables. Most of the variables (34) have been read as character variables, and some have been coded as factors in the preprocessing I did prior to this post. Excluding the <em>coordinates</em> and <em>crash_id-variable</em>, only the age of driver and cyclist, number of lanes and the number of units involved have been read as actual numeric variables.</p>
<p>An important point to note is therefore, that the dataset has a qualitative nature and is often quite text heavy (as will be pointed out shortly). This will pose a problem to certain machine learning methods, but we will have to adapt our analysis to methods fit for this kind of dataset - classification methods and geographic analysis tools might be a good place to start.</p>
<div id="how-many-missing-registrations" class="section level5">
<h5>How many missing registrations?</h5>
<p>Also we have a number of missing values across the dataset. This is also a problem for some models (eg. the standard random forest model), but we can work around this.</p>
<pre class="r"><code># How many missings are there across the dataset?
tibble(
  &quot;variable_name&quot; = colnames(bike_crash),
  &quot;number_of_rows&quot; = nrow(bike_crash),
  &quot;number_of_na&quot; = map_int(bike_crash, ~(sum(is.na(.x)))),
  &quot;pct_missing&quot; = number_of_na/number_of_rows*100) %&gt;% 
  mutate(pct_missing = case_when(pct_missing == Inf ~ 0, TRUE ~ pct_missing)) %&gt;% 
  print(n = ncol(bike_crash))</code></pre>
<pre><code>## # A tibble: 55 × 4
##    variable_name number_of_rows number_of_na pct_missing
##    &lt;chr&gt;                  &lt;int&gt;        &lt;int&gt;       &lt;dbl&gt;
##  1 x                      12173            0     0      
##  2 y                      12173            0     0      
##  3 objectid_1             12173            0     0      
##  4 ambulance_r            12173            0     0      
##  5 bike_age               12173          252     2.07   
##  6 bike_age_grp           12173          225     1.85   
##  7 bike_alc_drg           12173            0     0      
##  8 bike_alc_flg           12173          654     5.37   
##  9 bike_dir               12173          461     3.79   
## 10 bike_injury            12173          374     3.07   
## 11 bike_pos               12173          603     4.95   
## 12 bike_race              12173          299     2.46   
## 13 bike_sex               12173          235     1.93   
## 14 city                   12173            0     0      
## 15 county                 12173            0     0      
## 16 crash_alcoh            12173            0     0      
## 17 crash_day              12173            0     0      
## 18 crash_grp              12173           97     0.797  
## 19 crash_hour             12173            0     0      
## 20 crash_id               12173            0     0      
## 21 crash_loc              12173           10     0.0821 
## 22 crash_month            12173            0     0      
## 23 crash_sevr             12173           76     0.624  
## 24 crash_type             12173         2580    21.2    
## 25 crash_year             12173            0     0      
## 26 developmen             12173            0     0      
## 27 drvr_age               12173         1873    15.4    
## 28 drvr_age_grp           12173         1675    13.8    
## 29 drvr_alc_drg           12173            0     0      
## 30 drvr_alc_flg           12173         1762    14.5    
## 31 drvr_injury            12173         1754    14.4    
## 32 drvr_race              12173         1699    14.0    
## 33 drvr_sex               12173         1666    13.7    
## 34 drvr_veh_typ           12173         1000     8.21   
## 35 hit_run                12173            0     0      
## 36 latitude               12173            0     0      
## 37 light_cond             12173           66     0.542  
## 38 locality               12173            0     0      
## 39 longitude              12173            0     0      
## 40 num_lanes              12173          711     5.84   
## 41 num_units              12173            0     0      
## 42 rd_bent                12173           77     0.633  
## 43 rd_hill                12173           77     0.633  
## 44 rd_class               12173           91     0.748  
## 45 rd_conditio            12173           40     0.329  
## 46 rd_config              12173          143     1.17   
## 47 rd_defects             12173           55     0.452  
## 48 rd_feature             12173          547     4.49   
## 49 rd_surface             12173           57     0.468  
## 50 region                 12173            0     0      
## 51 rural_urban            12173            1     0.00821
## 52 speed_limit            12173          586     4.81   
## 53 traff_cntrl            12173          153     1.26   
## 54 weather                12173            0     0      
## 55 workzone               12173            0     0</code></pre>
</div>
<div id="how-text-heavy-are-the-variables" class="section level5">
<h5>How text heavy are the variables?</h5>
<pre class="r"><code>bike_crash %&gt;% count(crash_type, sort = T) </code></pre>
<pre><code>## # A tibble: 65 × 2
##    crash_type                                                n
##    &lt;chr&gt;                                                 &lt;int&gt;
##  1 &lt;NA&gt;                                                   2580
##  2 Motorist Drive Out - Sign-Controlled Intersection      1078
##  3 Motorist Left Turn - Opposite Direction                 911
##  4 Motorist Drive Out - Commercial Driveway / Alley        742
##  5 Bicyclist Ride Through - Sign-Controlled Intersection   580
##  6 Non-Roadway                                             538
##  7 Motorist Right Turn - Same Direction                    532
##  8 Bicyclist Left Turn - Same Direction                    451
##  9 Motorist Overtaking - Undetected Bicyclist              439
## 10 Bicyclist Ride Through - Signalized Intersection        404
## # … with 55 more rows</code></pre>
<p>Not only is the length of the text, but also the sheer number of categories (65!). This variable will therefore problably be used in my modelling (unless we look specifically at a certain situation). But take a look at this one:</p>
<pre class="r"><code>bike_crash %&gt;% count(drvr_veh_typ, sort = T) %&gt;% print(n = 100)</code></pre>
<pre><code>## # A tibble: 25 × 2
##    drvr_veh_typ                             n
##    &lt;chr&gt;                                &lt;int&gt;
##  1 Passenger Car                         6363
##  2 Sport Utility                         2086
##  3 Pickup                                1554
##  4 &lt;NA&gt;                                  1000
##  5 Van                                    574
##  6 Light Truck (Mini-Van, Panel)          169
##  7 Single Unit Truck (2-Axle, 6-Tire)      83
##  8 Motorcycle                              61
##  9 Police                                  59
## 10 Commercial Bus                          29
## 11 Tractor/Semi-Trailer                    29
## 12 Pedalcycle                              28
## 13 Truck/Trailer                           27
## 14 Single Unit Truck (3 Or More Axles)     23
## 15 School Bus                              22
## 16 Taxicab                                 19
## 17 Other Bus                               18
## 18 Moped                                    9
## 19 Pedestrian                               7
## 20 Motor Home/Recreational Vehicle          4
## 21 EMS Vehicle, Ambulance, Rescue Squad     3
## 22 Activity Bus                             2
## 23 Truck/Tractor                            2
## 24 All Terrain Vehicle (ATV)                1
## 25 Firetruck                                1</code></pre>
<p>We are a bit luckier this time. We have 25 categories but for 19 of them we have less than 100 registrations. Are we to gather these in an other category? Maybe. But for now we’ll leave them as they are.</p>
</div>
<div id="initial-visualisation-of-the-data-where-do-accidents-occurr" class="section level3">
<h3><strong>Initial visualisation of the data: <em>Where</em> do accidents occurr?</strong></h3>
<p>First of all it would be interesting to see where accidents occur. Mapping crash locations over such a large area gives us a quite cluttered picture. Adjusting the transparency of the dots can provide us with a clearer picture but other visualisation methods might yield a more correct visualisation. I will show how that can be done in a later post! [upcoming link]</p>
<pre class="r"><code># Load some additional packages
pacman::p_load(sf,             # Essential package for working with geographic data
               tmap            # Mapping tool
               )

# Read in counties geometry
nc_counties &lt;- read_rds(&quot;~/R/Projects/bike_crash/processed_data/nc_counties_geom.rds&quot;)

# Wehere do bike crashes occur?
st_as_sf(bike_crash, coords = c(x = &quot;x&quot;, y = &quot;y&quot;), crs = &quot;NAD83&quot;) %&gt;%
  tm_shape() + 
  tm_dots(alpha = 0.1) + 
  tm_shape(nc_counties) + 
  tm_borders(alpha = 0.4, lwd = 1.3) + 
  tm_layout(frame = TRUE,
            main.title = &quot;Crashes in North Carolina 2007-2019&quot;, 
            main.title.position = &quot;center&quot;,
            main.title.fontfamily = &quot;IBM Plex Sans&quot;,
            main.title.size = 1,
            ) </code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The map also suggests that a majority of the crashes take place in urban areas, and less so in rural areas. This of course not an earth shaking insight, but it is certainly not an irrelevant point for further analysis.</p>
<p>Here’s a map of the population size by county:</p>
<pre class="r"><code># Read in population data
nc_pop &lt;- read_rds(&quot;~/R/Projects/bike_crash/processed_data/ncpop_09_19.rds&quot;) %&gt;% st_as_sf()

# Create population chloropeth map
tm_shape(nc_pop) +
  tm_polygons(&quot;est_2015&quot;, title = &quot;Population size (jenks)&quot;, style = &quot;jenks&quot;) + 
  tm_layout(main.title = &quot;Population size by county (2015)&quot;, 
            main.title.position = &quot;center&quot;,
            main.title.fontfamily = &quot;IBM Plex Sans&quot;,
            main.title.size = .95,
            frame = TRUE,
            legend.title.fontfamily = &quot;IBM Plex Sans&quot;,
            legend.title.size = 0.85,
            legend.text.fontfamily = &quot;IBM Plex Sans&quot;,
            legend.text.size = 0.6,
            legend.width = 8,
            legend.height = 10) </code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>And a simple test for correlation confirms this picture. The correlation coefficient for population size and number of accidents pr. county is 0.95. Very high!</p>
<pre class="r"><code># We need to specify the geometry once and for all this time
bike_crash &lt;- st_as_sf(bike_crash, coords = c(x = &quot;x&quot;, y = &quot;y&quot;), crs = &quot;NAD83&quot;)

# Count number of accidents pr. counties
nc_pop &lt;- nc_pop %&gt;% 
  mutate(n_accidents = lengths(st_intersects(., bike_crash)))

# Correlations test 
cor.test(x = nc_pop$est_2015, y =  nc_pop$n_accidents, method = &quot;pearson&quot;)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  nc_pop$est_2015 and nc_pop$n_accidents
## t = 30.804, df = 98, p-value &lt; 0.00000000000000022
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9294293 0.9675352
## sample estimates:
##       cor 
## 0.9520451</code></pre>
</div>
<div id="when-do-accidents-ocurr" class="section level3">
<h3>** <em>When</em> do accidents ocurr?**</h3>
<pre class="r"><code># It&#39;s better to drop the geometry before making for summarising operations. This speeds up the process significantly!
bike_crash &lt;- st_drop_geometry(bike_crash)

# Set standard theming
theme_set(hrbrthemes::theme_ipsum_ps())

# Plotting crashes over time
cowplot::plot_grid(
  bike_crash %&gt;% count(crash_year) %&gt;% 
    ggplot(aes(x = crash_year, y = n)) + 
    geom_col() + 
    theme(axis.text.x=element_text(angle=90, hjust=1)),
  bike_crash %&gt;% 
    count(crash_month) %&gt;% 
    ggplot(aes(x = crash_month, y = n)) + 
    geom_col() + 
    theme(axis.text.x=element_text(angle=90, hjust=1)),
  bike_crash %&gt;% 
    count(crash_hour) %&gt;% 
    ggplot(aes(x = crash_hour, y = n)) + 
    geom_col()+ 
    theme(axis.text.x=element_text(angle=45, hjust=1)),
  bike_crash %&gt;% 
    count(crash_day) %&gt;% 
    ggplot(aes(x = crash_day, y = n)) + 
    geom_col() + 
    theme(axis.text.x=element_text(angle=90, hjust=1)))</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Plotting the time dimension also gives us a better understanding of underlying causes behind the accidents.</p>
<ul>
<li>Unfortunately the number of accidents seems to have remained on the same level in the period 2007 - 2019. There are fluctuations but - based on a simple visualisation - I would be hesitant to conclude that we have observed a decrease in the number of accidents over the years. It would also be interesting to compare this to the development of traffic volume in the state (or in specified areas) but unfortunately we don’t have acces to this information.</li>
<li>There seems to be a seasonality effect at play. The number of accidents begins rising in March and by May we have reached a level which is held until September, when it begins to drop again. This is likely correlated with traffic volumes - ie. more people use their bikes when weather conditions are better. This is however a speculation not backed by data.</li>
<li>Also the number of accident increases slowly from 5 in the morning until 5 in the evening where we see a steep drop.</li>
<li>Finally we see that less accidents take place during the weekends. I will abstain from speculating why.</li>
</ul>
</div>
<div id="concluding-remarks" class="section level1">
<h1>Concluding remarks:</h1>
<ul>
<li>I have introduced the dataset I will be working with in my first few blogposts.</li>
<li>The dataset is highly qualitative in nature and is probably best fit for classification-type models and experimenting geographic analysis tools.</li>
</ul>
<p>Stay tuned!</p>
</div>
